function addRestaurant(){check=1;var e=document.getElementById("addName"),t=document.getElementById("addLocation"),n=document.getElementById("addPrice"),o=document.getElementById("addDuration"),a=table.insertRow(table.rows.length),l=a.insertCell(0),r=a.insertCell(1),i=a.insertCell(2),s=a.insertCell(3),c=a.insertCell(4),d=document.createElement("img");d.style.height="65px",d.style.width="65px",d.src="../images/defaultPlaceImage.png",l.appendChild(d),r.innerHTML=e.value,i.innerHTML=n.value,s.innerHTML=t.value,c.innerHTML='<paper-button onclick="editRestaurant('+table.rows.length+');" raised class="red"><i class="material-icons">create</i></paper-button>';var u,m=FIRRef.child("Restaurants");m.on("value",function(e){u=e.numChildren()}),m.child(u+1).set({accessType:"Walk",duration:o.value,visitTimes:0,visitedYesterday:0,location:t.value,name:e.value,picture:"",price:parseInt(n.value)}),e.value="",t.value="",n.value=""}function editRestaurant(e){check=1;var t=table.rows[e-1].cells[1].innerHTML,n=table.rows[e-1].cells[2].innerHTML,o=table.rows[e-1].cells[3].innerHTML;oldRestName=table.rows[e-1].cells[1].innerHTML,oldPrice=table.rows[e-1].cells[2].innerHTML,oldLocation=table.rows[e-1].cells[3].innerHTML,globalCell=e-1,console.log(table.rows[e-1].cells[1].innerHTML),dialogForEdit.open();var a=document.getElementById("editRestaurantName");a.value=t,newRestName=document.getElementById("editRestaurantName");var l=document.getElementById("editRestaurantPrice");l.value=n,newPrice=document.getElementById("editRestaurantPrice");var r=document.getElementById("editRestaurantLocation");r.value=o,newLocation=document.getElementById("editRestaurantLocation")}function saveRestaurant(){check=1,table.rows[globalCell].cells[1].innerHTML=document.getElementById("editRestaurantName").value,table.rows[globalCell].cells[2].innerHTML=document.getElementById("editRestaurantPrice").value,table.rows[globalCell].cells[3].innerHTML=document.getElementById("editRestaurantLocation").value;var e=document.getElementById("memberList").selected,t=document.getElementById("pointList").selected;voter=document.getElementById("member"+(e+1)).innerHTML,voter=nameFixer(voter),point=t+1,console.log("voter: "+voter),console.log("selectedMember: "+e),console.log("point: "+point);var n=FIRRef.child("Restaurants");n.on("value",function(e){e.forEach(function(e){console.log(oldRestName),e.val().name==oldRestName&&(e.ref.update({name:newRestName.value}),e.ref.update({price:newPrice.value}),e.ref.update({location:newLocation.value}),updatedObj={},updatedObj[voter]=-point,e.ref.child("Voters").update(updatedObj),restVoters=e.ref.child("Voters"),totalpoint=0,countForPoints=1,restVoters.on("value",function(t){t.forEach(function(n){totalpoint+=n.val(),console.log("totalpoint: "+totalpoint),t.numChildren()==countForPoints&&(console.log("counter: "+countForPoints),console.log("totalpoint yazıldı: "+totalpoint),e.ref.update({points:totalpoint})),countForPoints++})}))})})}function nameFixer(e){for(var t="",n=0,o=0;o<e.length;o++)if(" "!=e[o]&&"\n"!=e[o]&&(n=1),1==n&&(t+=e[o],"\n"==e[o+1]))return t}var config={apiKey:"AIzaSyC83fcF4D4JhK2rBClQ-xid1U6SaVH9Xlc",authDomain:"project2-hw1.firebaseapp.com",databaseURL:"https://project2-hw1.firebaseio.com",storageBucket:"project2-hw1.appspot.com",messagingSenderId:"980282935378"};firebase.initializeApp(config);var FIRRef=firebase.database().ref(),memberContainer=document.getElementById("membercontainer"),table,globalCell,oldRestName,oldPrice,oldLocation,oldDuration,newDuration,newRestName,newPrice,newLocation,check=0,counter=1,countForPoints=1,voter,point,updatedObj,totalpoint,restVoters,dropDownForMembers='<paper-listbox class="dropdown-content" id="memberList">';if(null==document.getElementById("restaurant"))console.log("restaurant is null"),location.reload();else{console.log("else girdim restaurant");var Members=FIRRef.child("Users");Members.on("value",function(e){e.forEach(function(t){1!=check&&(console.log(dropDownForMembers),console.log(t.val().name),dropDownForMembers=dropDownForMembers+'\n<paper-item id="member'+counter+'">'+t.val().name+"</paper-item>",counter++,counter==e.numChildren()+1&&(dropDownForMembers+="\n</paper-listbox>\n",memberContainer.innerHTML=dropDownForMembers))})});var Restaurants=FIRRef.child("Restaurants");table=document.getElementById("restaurant").getElementsByTagName("tbody")[0],Restaurants.on("value",function(e){e.forEach(function(e){if(1!=check){var t=table.insertRow(table.rows.length),n=t.insertCell(0),o=t.insertCell(1),a=t.insertCell(2),l=t.insertCell(3),r=t.insertCell(4),i=document.createElement("img");i.style.height="65px",i.style.width="65px",""==e.val().picture?i.src="../images/defaultPlaceImage.png":i.src=e.val().picture,n.appendChild(i),o.innerHTML=e.val().name,a.innerHTML=e.val().price,l.innerHTML=e.val().location,r.innerHTML='<paper-button onclick="editRestaurant('+table.rows.length+');" raised class="red"><i class="material-icons">create</i></paper-button>'}})})}